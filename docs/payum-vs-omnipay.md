# Payum vs Omnipay

The short answer is - Payum provides the same functionality as Omnipay, plus some extra features.

Payum works best when you combine a payment model with a convert action. The model is not required to be [Payum-specific model](https://github.com/Payum/Payum/blob/master/src/Payum/Core/Model/Payment.php), I encourage you to use your own or one from a [ecommerce platform](https://github.com/Sylius/Sylius/blob/master/src/Sylius/Component/Payment/Model/Payment.php). The idea is simple: you send a request to Payum to capture your model. In the action you [convert the payment model to a gateway specific format](https://github.com/Payum/Payum/blob/master/src/Payum/Paypal/ExpressCheckout/Nvp/Action/ConvertPaymentAction.php), most probably an array. The beauty of this approach is that your code is consistent, and looks like this:

    $gateway->execute(new Capture($payment));

All gateway’s differences are hidden inside a gateway. Of course, Payum supports a gateway specific format, as well as a Payum-specific model. In the case of Omnipay you cannot simply replace a Stripe gateway with PayPal one, because they behave differently and most importantly require different data. Stripe requires a credit card to be provided where PayPal does not care about it, but instead wants return and cancel URL(s) to be set. You have to reflect these differences in your code. Payum generates secure cancel and return URL(s) (we will talk about it later).

Sometimes you have to get more details about the payment transaction, or a payer, or more info about an error. Payum provides you access to all data that takes part in a communication between your code and a payment gateway. The data format is a payment specific, so if you familiar with [the Paypal protocol](https://developer.paypal.com/docs/classic/express-checkout/gs_expresscheckout/) it would be easy for you to understand what is going on there. Another good example is Klarna Checkout. It returns shipping\billing addresses, gender and date of birth. With Payum you can easily get these out of the payment callback and use for your own needs.

Payum provides you with better status handling. Omnipay provides two statuses -  "success" and "failed", but that is not enough. For example - PayPal sometimes returns a status of "pending" because of [multi currency issues](http://stackoverflow.com/questions/19864511/paypal-sandbox-pending-multicurrency). In this case Omnipay says the payment has failed, but in fact it has not. The user can also cancel the payment on PayPal's side, Omnipay will tell you it has failed, but in reality it has not. If you need a status which is not provided by default from Payum, you can easily add it yourself. Do you already have payment statuses, maybe your [ecommerce platform] provides (https://github.com/Sylius/Sylius/blob/master/src/Sylius/Bundle/PayumBundle/Payum/Request/GetStatus.php#L24) them and you want to reuse, no problem - Payum could be adjusted to use them.

Sometimes users want to cheat on you or pay less for the ordered items. As a developer you have to take it into consideration and take care of your data. What do you expose to a user? Could it be used the wrong way? You can not rely on an amount given in the URL, until you validate it. For example PayPal sends you a push notification to the IPN URL you previously sent to them. Payum generates for you such an URL and when the notification comes back it validates it. You get unique, secured URL(s) out of the box. The payment is internally associated with that URL, and once you remove\invalidate the url the user is denied access to the payment behind it. Omnipay does not provide anything to help you solve security issues. There is one good side effect of these secure URL(s) - they are invalidated\deleted once they not needed. This is good, for example when the user clicks the “Back” button in his browser he would not be able to do a second payment because the purchase URL no longer exists, instead he will see a 404 error.

It is not a good practice to store credit cards at your side, is it? There is no excuse for storing them accidentally, or just for few seconds. Payum has a [sensitive value](https://github.com/Payum/Payum/blob/master/src/Payum/Core/Security/SensitiveValue.php) object which ensures that nothing is saved accidentally. You are still able to store it, but when doing so you are on your own.

Omnipay supports only gateways, that do a redirect to gateway side or require a credit card. But there are many other gateways, and they act differently. For example Klarna Checkout [require a snippet (iframe) to be rendered](https://developers.klarna.com/en/se+php/kco-v2/checkout/2-embed-the-checkout), Stripe.Js [requires their javascript to be executed](https://stripe.com/docs/stripe.js?) on a purchase page. Stripe Checkout [renders its own popup](https://stripe.com/docs/checkout). Payum [supports them all](supported-gateways.md), and as we talked at the beginning you can switch from one gateway to another without changes in your code. Payum does not natively support a gateway you need? I do not think reimplementing every gateway in house is a good idea. That’s why a [bridge for Omnipay gateways exists](index.md#omnipay-bridge-external). It allows you to use Omnipay gateways the Payum way.

Payum tries to [standardise the payment flow](get-it-started.md). There are three steps prepare, capture\authorise and done. The first one is called “prepare” and at this step you have to prepare the payment, calculate total prices, taxes, get user or shipping information and so on. Once you are done you can redirect user to a capture\authorise step, From here user could be redirected to a gateway side or asked for a credit card, or something else. It depends on what gateway you chose. At “done” step you have to get the payment status and act according to it. Omnipay only partly solves this task.

With a gateway factories you can easily overwrite\replace any parts of the gateway functionally, or add a custom actions, extensions or apis.

Payum has official extensions for most modern frameworks such as [Symfony](https://github.com/Payum/PayumBundle). [Laravel](https://github.com/Payum/PayumLaravelPackage), [Silex](https://github.com/Payum/PayumSilexProvider), [Yii](https://github.com/Payum/PayumYiiExtension),  [Zend](https://github.com/Payum/PayumModule).

At the end lets compare the corner stone interfaces from Payum and Omnipay.

* Payum [GatewayInterface](https://github.com/Payum/Payum/blob/master/src/Payum/Core/GatewayInterface.php) vs Omnipay [GatewayInterface](https://github.com/thephpleague/omnipay-common/blob/master/src/Common/GatewayInterface.php)
* Payum [GatewayFactoryInterface](https://github.com/Payum/Payum/blob/master/src/Payum/Core/GatewayFactoryInterface.php) vs Omnipay [GatewayFactory](https://github.com/thephpleague/omnipay-common/blob/master/src/Common/GatewayFactory.php) ups there is not an interface.

Back to [index](index.md).
